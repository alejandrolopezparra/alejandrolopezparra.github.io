<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Amazon on Alejandro López Parra</title>
    <link>http://www.alejandrolopezparra.es/tags/amazon/</link>
    <description>Recent content in Amazon on Alejandro López Parra</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es-es</language>
    <copyright>&amp;copy; 2017 Alejandro López Parra</copyright>
    <lastBuildDate>Sat, 25 Mar 2017 16:39:03 +0100</lastBuildDate>
    <atom:link href="/tags/amazon/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Generar estadísticas de websites con AWStats</title>
      <link>http://www.alejandrolopezparra.es/post/awstats/</link>
      <pubDate>Sat, 25 Mar 2017 16:39:03 +0100</pubDate>
      
      <guid>http://www.alejandrolopezparra.es/post/awstats/</guid>
      <description>

&lt;p&gt;Después del &lt;a href=&#34;http://www.alejandrolopezparra.es/post/amazon_s3_logs/&#34;&gt;anterior post&lt;/a&gt;, dedicado al registro de accesos a un website alojado en &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html&#34; target=&#34;_blank&#34;&gt;Amazon S3&lt;/a&gt; gracias a la característica &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html&#34; target=&#34;_blank&#34;&gt;access logging&lt;/a&gt;, continuamos con lo realmente importante: &lt;strong&gt;el análisis de logs&lt;/strong&gt;. Esto es fundamental para obtener estadísticas de nuestro website y conocer qué uso, tanto legítimo como inapropiado, se hace de él desde Internet. Para llevarlo a cabo, se tratará la instalación, configuración y uso de la herramienta de software libre &lt;a href=&#34;http://www.awstats.org&#34; target=&#34;_blank&#34;&gt;AWStats&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;AWStats&lt;/em&gt; es un analizador de logs que genera estadísticas y gráficas en &lt;em&gt;HTML&lt;/em&gt; sobre el uso de servidores web, ftp, streaming y de correo. Éstos son algunos ejemplos de las estadísticas que es capaz de obtener a partir de los logs:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Número de visitas, de visitantes únicos y de robots.&lt;/li&gt;
&lt;li&gt;Horas y días de la semana de más uso.&lt;/li&gt;
&lt;li&gt;Países, ciudades y direcciones IP desde los que se accede.&lt;/li&gt;
&lt;li&gt;Navegadores y sistemas operativos usados por los clientes.&lt;/li&gt;
&lt;li&gt;Ranking de páginas más visitadas.&lt;/li&gt;
&lt;li&gt;Errores HTTP.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Está escrito en &lt;em&gt;Perl&lt;/em&gt; y, por tanto, disponible para múltiples sistemas operativos (&lt;a href=&#34;https://es.wikipedia.org/wiki/GNU/Linux&#34; target=&#34;_blank&#34;&gt;&lt;em&gt;GNU/Linux&lt;/em&gt;&lt;/a&gt;, &lt;a href=&#34;https://es.wikipedia.org/wiki/MacOS&#34; target=&#34;_blank&#34;&gt;&lt;em&gt;macOS&lt;/em&gt;&lt;/a&gt;, &lt;a href=&#34;https://es.wikipedia.org/wiki/Microsoft_Windows&#34; target=&#34;_blank&#34;&gt;&lt;em&gt;Windows&lt;/em&gt;&lt;/a&gt;, etc.).&lt;/p&gt;

&lt;p&gt;Básicamente tiene 2 modos de funcionamiento:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Common Gateway Interface (CGI)&lt;/strong&gt;: para ser integrado con un servidor web como &lt;em&gt;Apache HTTP Server&lt;/em&gt; o &lt;em&gt;nginx&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Línea de comandos (CLI)&lt;/strong&gt;: para ser ejecutado desde un intérprete de comandos.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;En el caso que nos ocupa, se usará desde la &lt;em&gt;CLI&lt;/em&gt; y sólo para analizar logs de acceso al servidor web de &lt;em&gt;Amazon S3&lt;/em&gt;. A continuación se describen los pasos para hacerlo funcionar: (1) descargar bases de datos de geolocalización, (2) instalar &lt;em&gt;Perl&lt;/em&gt;, (3) instalar y configurar &lt;em&gt;AWStats&lt;/em&gt;, y (4) generar informes con &lt;em&gt;AWStats&lt;/em&gt;.&lt;/p&gt;

&lt;h2 id=&#34;1-descargar-bases-de-datos-de-geolocalización&#34;&gt;1. Descargar bases de datos de geolocalización&lt;/h2&gt;

&lt;p&gt;El primer paso a realizar es descargar la base de datos de geolocalización que se usará para poder obtener el país, sistema autónomo (ASN), organización, región y/o ciudad de cada una de las direcciones IP desde las que visiten nuestro website. &lt;em&gt;AWStats&lt;/em&gt; soporta tres proveedores de bases de datos:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://software77.net/geo-ip/&#34; target=&#34;_blank&#34;&gt;GeoIPFree&lt;/a&gt;: es gratuita y libre pero sólo proporciona base de datos para el &lt;a href=&#34;http://software77.net/geo-ip/?DL=4&#34; target=&#34;_blank&#34;&gt;país&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://dev.maxmind.com/geoip/legacy/geolite/&#34; target=&#34;_blank&#34;&gt;MaxMind GeoLite&lt;/a&gt;: es gratuita y proporciona bases de datos para el &lt;a href=&#34;http://geolite.maxmind.com/download/geoip/database/GeoLiteCountry/GeoIP.dat.gz&#34; target=&#34;_blank&#34;&gt;país&lt;/a&gt;, &lt;a href=&#34;http://download.maxmind.com/download/geoip/database/asnum/GeoIPASNum.dat.gz&#34; target=&#34;_blank&#34;&gt;ASN&lt;/a&gt; y &lt;a href=&#34;http://geolite.maxmind.com/download/geoip/database/GeoLiteCity.dat.gz&#34; target=&#34;_blank&#34;&gt;ciudad&lt;/a&gt;. Se actualizan el primer martes de cada mes.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://dev.maxmind.com/geoip/legacy/&#34; target=&#34;_blank&#34;&gt;MaxMind GeoIP&lt;/a&gt;: es comercial y proporciona bases de datos para el país, ASN, organización, región y ciudad. Se actualizan todas las semanas.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;En este caso, optaremos por las 3 bases de datos de &lt;em&gt;MaxMind GeoLite&lt;/em&gt; así que, una vez descargadas, será necesario descomprimirlas:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;gunzip -f GeoIP.dat.gz GeoIPASNum.dat.gz GeoLiteCity.dat.gz&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&#34;2-instalar-perl&#34;&gt;2. Instalar Perl&lt;/h2&gt;

&lt;p&gt;La mayoría de los sistemas operativos vienen con el intérprete de &lt;em&gt;Perl&lt;/em&gt; pre-instalado o disponen de un instalador que facilita la labor. Éste es el caso de &lt;em&gt;macOS&lt;/em&gt;, que ya cuenta con &lt;em&gt;Perl&lt;/em&gt; como parte de las utilidades que acompañan al sistema operativo así que no es necesario instalarlo.&lt;/p&gt;

&lt;p&gt;Sin embargo, además del intérprete de &lt;em&gt;Perl&lt;/em&gt;, es necesario disponer del módulo &lt;a href=&#34;http://search.cpan.org/~maxmind/Geo-IP-1.50/lib/Geo/IP.pm&#34; target=&#34;_blank&#34;&gt;Geo::IP&lt;/a&gt; de &lt;em&gt;MaxMind&lt;/em&gt; para &lt;em&gt;Perl&lt;/em&gt; de forma que &lt;em&gt;AWStats&lt;/em&gt; pueda hacer uso de sus bases de datos de geolocalización. En macOS y otros sistemas operativos, es tan fácil como ejecutar el comando &lt;a href=&#34;https://metacpan.org/pod/distribution/CPAN/scripts/cpan&#34; target=&#34;_blank&#34;&gt;cpan&lt;/a&gt; que viene con &lt;em&gt;Perl&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;cpan Geo::IP&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Si no disponemos de permisos de root/administrador o &lt;strong&gt;por seguridad&lt;/strong&gt;, podemos ejecutarlo con un usuario sin privilegios pero, antes, hay que instalar &lt;a href=&#34;https://metacpan.org/pod/local::lib&#34; target=&#34;_blank&#34;&gt;local::lib&lt;/a&gt; (un módulo de &lt;em&gt;Perl&lt;/em&gt; que permite instalar módulos en directorios locales). Para llevarlo a cabo, lo más recomendable es usar la &lt;a href=&#34;https://metacpan.org/pod/local::lib#The-bootstrapping-technique&#34; target=&#34;_blank&#34;&gt;técnica bootstrapping&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;3-instalar-y-configurar-awstats&#34;&gt;3. Instalar y configurar AWStats&lt;/h2&gt;

&lt;p&gt;Ahora sí, una vez cubiertos todos los requisito previos, llega el momento de descargar &lt;em&gt;AWStats&lt;/em&gt; desde su &lt;a href=&#34;http://www.awstats.org/#DOWNLOAD&#34; target=&#34;_blank&#34;&gt;web oficial&lt;/a&gt; y descomprimirlo para posteriormente configurarlo según las &lt;a href=&#34;http://www.awstats.org/docs/awstats_setup.html&#34; target=&#34;_blank&#34;&gt;instrucciones oficiales&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Básicamente la configuración consiste en crear un fichero &lt;em&gt;awstats.$myserver.conf&lt;/em&gt; con todas las opciones de configuración necesarias y donde &lt;em&gt;$myserver&lt;/em&gt; es el nombre del servidor que aparecerán en los logs. Existen 2 posibilidades para llevarlo a cabo:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;El uso del script &lt;em&gt;awstats_configure.pl&lt;/em&gt;, que crea el fichero de configuración a partir de las respuestas a las preguntas que interactivamente realiza al usuario. Esta primera alternativa &lt;strong&gt;no es recomendable&lt;/strong&gt; a no ser que los logs que se pretendan analizar sean generados por un servidor web &lt;em&gt;Apache HTTP Server&lt;/em&gt; que esté instalado en la misma máquina que &lt;em&gt;AWStats&lt;/em&gt;, ya que intenta modificar directamente la configuración de dicho servidor y reiniciarlo después.&lt;/li&gt;
&lt;li&gt;A partir del fichero de configuración de ejemplo que viene &lt;em&gt;awstats.model.conf&lt;/em&gt;, copiándolo como &lt;em&gt;awstats.$myserver.conf&lt;/em&gt; y modificando las valores por defecto de las opciones.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Aunque las opciones están bien documentadas en el fichero de configuración de ejemplo y en la &lt;a href=&#34;http://www.awstats.org/docs/awstats_config.html&#34; target=&#34;_blank&#34;&gt;web oficial&lt;/a&gt;, las más importantes son las siguientes:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;En el apartado &lt;em&gt;MAIN SETUP SECTION&lt;/em&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;LogFile=&amp;quot;access.log&amp;quot;
LogFormat=&amp;quot;%other %virtualname %time1 %host %extra1 %other %extra2 %url %methodurl %code %extra3 %bytesd %other %extra4 %extra5 %refererquot %uaquot %other&amp;quot;
SiteDomain=&amp;quot;www.alejandrolopezparra.es&amp;quot;
HostAliases=&amp;quot;localhost 127.0.0.1&amp;quot;
DirIcons=&amp;quot;icon&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;En el apartado &lt;em&gt;PLUGINS&lt;/em&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;LoadPlugin=&amp;quot;geoip GEOIP_STANDARD GeoIP.dat&amp;quot;
LoadPlugin=&amp;quot;geoip_city_maxmind GEOIP_STANDARD GeoLiteCity.dat&amp;quot;
LoadPlugin=&amp;quot;geoip_asn_maxmind GEOIP_STANDARD GeoIPASNum.dat+http://enc.com.au/itools/autnum.php?asn=&amp;quot;
LoadPlugin=&amp;quot;timezone CET&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;4-generar-informes-con-awstats&#34;&gt;4. Generar informes con AWStats&lt;/h2&gt;

&lt;p&gt;Una vez que hemos conseguido instalar y configurar todas las herramientas necesarias, es el momento de generar los informes con las estadísticas desde los logs de nuestro website.&lt;/p&gt;

&lt;p&gt;El primer paso es construir la base de datos de estadísticas para comprobar si hay algún error, con el comando:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;awstats.pl -config=$myserver -update&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Cuando esto se haya completado correctamente, ya se podrá solicitar a &lt;em&gt;AWStats&lt;/em&gt; que genere todos los informes posibles con el comando:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;awstats_buildstaticpages.pl -config=$myserver -update -month=all -configdir=$configdir -awstatsprog=$awstatsprog&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;donde&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;em&gt;$myserver&lt;/em&gt; es el nombre del servidor tal y como aparece en los logs.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;$configdir&lt;/em&gt; es el directorio donde esté el fichero de configuración &lt;em&gt;awstats.$myserver.conf&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;$awstatsprog&lt;/em&gt; es la ruta al comando &lt;em&gt;awstats.pl&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;El resultado final son una serie de documentos HTML que contienen los informes general y detallados de cada una de las estadísticas que recopila &lt;em&gt;AWStats&lt;/em&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;awstats.$myserver.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.alldomains.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.allhosts.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.lasthosts.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.unknownip.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.alllogins.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.lastlogins.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.allrobots.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.lastrobots.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.urldetail.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.urlentry.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.urlexit.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.browserdetail.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.osdetail.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.unknownbrowser.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.unknownos.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.refererse.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.refererpages.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.keyphrases.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.keywords.html&lt;/li&gt;
&lt;li&gt;awstats.$myserver.errors404.html&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;conclusión&#34;&gt;Conclusión&lt;/h2&gt;

&lt;p&gt;Aunque &lt;em&gt;AWStats&lt;/em&gt; dispone de buena &lt;a href=&#34;http://www.awstats.org/docs/index.html&#34; target=&#34;_blank&#34;&gt;documentación oficial&lt;/a&gt;, no es nada sencillo ni intuitivo usar la herramienta por primera vez debido a la cantidad de opciones que ofrece.&lt;/p&gt;

&lt;p&gt;No obstante, una vez superada esa fase, los informes generados por esta herramienta facilitan mucho el análisis de los logs. &lt;a href=&#34;http://www.nltechno.com/awstats/awstats.pl?config=destailleur.fr&#34; target=&#34;_blank&#34;&gt;Aquí&lt;/a&gt; se puede encontrar una demonstración de las estadísticas que puede recopilar.&lt;/p&gt;

&lt;p&gt;Por supuesto, &lt;em&gt;AWStats&lt;/em&gt; no es la única alternativa para generar informes y estadísticas de nuestros logs. De hecho, la propia web oficial recoge una &lt;a href=&#34;http://www.awstats.org/docs/awstats_compare.html&#34; target=&#34;_blank&#34;&gt;comparación&lt;/a&gt; entre algunas de las herramientas que existen.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Logs de acceso a websites en Amazon S3</title>
      <link>http://www.alejandrolopezparra.es/post/amazon_s3_logs/</link>
      <pubDate>Sat, 04 Mar 2017 15:39:03 +0100</pubDate>
      
      <guid>http://www.alejandrolopezparra.es/post/amazon_s3_logs/</guid>
      <description>

&lt;p&gt;Después del &lt;a href=&#34;http://www.alejandrolopezparra.es/post/amazon_s3/&#34;&gt;anterior post&lt;/a&gt; dedicado al alojamiento de websites estáticos en &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html&#34; target=&#34;_blank&#34;&gt;Amazon S3&lt;/a&gt;, es el momento de tratar la gestión de los logs o registros de acceso a nuestro website. Posteriormente nos centremos en el &lt;a href=&#34;http://www.alejandrolopezparra.es/post/awstats/&#34;&gt;análisis de logs&lt;/a&gt; que es fundamental para obtener estadísticas de nuestro website y conocer qué uso, tanto legítimo como inapropiado, se hace de él desde Internet.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Amazon S3&lt;/em&gt; dispone de una característica denominada &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html&#34; target=&#34;_blank&#34;&gt;access logging&lt;/a&gt; que permite registrar los accesos que se producen a nuestro website en ficheros de logs. A continuación se describen los pasos para (1) habilitar, (2) purgar y (3) descargar dichos logs a un directorio local.&lt;/p&gt;

&lt;h2 id=&#34;1-activar-el-registro-de-accesos&#34;&gt;1. Activar el registro de accesos&lt;/h2&gt;

&lt;p&gt;El registro de accesos o access logging se habilita con unos &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/enable-logging-console.html&#34; target=&#34;_blank&#34;&gt;sencillos pasos&lt;/a&gt;. De esta forma, con cada petición de acceso se genera un &lt;em&gt;nuevo&lt;/em&gt; fichero que se almacena en el &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html&#34; target=&#34;_blank&#34;&gt;Bucket&lt;/a&gt; que hayamos seleccionado para tal fin y que tendrá asociado un nombre único (por ejemplo, &lt;em&gt;mybucket&lt;/em&gt;). En dichos ficheros se registran los datos de los accesos (&lt;em&gt;requester, bucket name, request time, request action, response status, error code&lt;/em&gt;) siguiendo el formato de log que se explica &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/LogFormat.html&#34; target=&#34;_blank&#34;&gt;aquí&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;2-purgar-los-ficheros-de-logs&#34;&gt;2. Purgar los ficheros de logs&lt;/h2&gt;

&lt;p&gt;Es importante considerar que, con el paso del tiempo, el espacio ocupado por estos ficheros de logs irá creciendo. Esto puede llegar a ser un problema no sólo en lo que respecta al volumen sino también económicamente hablando, ya que también se paga por el espacio ocupado. Para evitar sorpresas, lo más recomendable es configurar el &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/user-guide/setup-lifecycle.html&#34; target=&#34;_blank&#34;&gt;ciclo de vida de objetos&lt;/a&gt; que posibilita, de forma automática, purgar ficheros o moverlos a &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/dev/storage-class-intro.html&#34; target=&#34;_blank&#34;&gt;otro almacenamiento&lt;/a&gt; más barato en base a su tiempo de vida.&lt;/p&gt;

&lt;h2 id=&#34;3-descargar-los-ficheros-de-logs&#34;&gt;3. Descargar los ficheros de logs&lt;/h2&gt;

&lt;p&gt;Para poder trabajar con los ficheros de logs generados, es necesario descargarlos previamente desde donde se encuentren. Esto se puede hacer de forma manual, que no es muy operativo, o automatizada. Para la segunda opción necesitaremos crear un usuario que nos permita usar la &lt;a href=&#34;http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-welcome.html&#34; target=&#34;_blank&#34;&gt;Interfaz de Línea de Comandos (CLI)&lt;/a&gt; de &lt;em&gt;Amazon Web Services (AWS)&lt;/em&gt; contra la &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/API/Welcome.html&#34; target=&#34;_blank&#34;&gt;Interfaz de Programación de Aplicaciones (API)&lt;/a&gt; de &lt;em&gt;Amazon S3&lt;/em&gt;. Los pasos para poder llevarlo a cabo son los siguientes:&lt;/p&gt;

&lt;h3 id=&#34;3-1-crear-un-usuario-con-permisos-de-lectura&#34;&gt;3.1. Crear un usuario con permisos de lectura&lt;/h3&gt;

&lt;p&gt;Antes de poder usar la CLI de AWS contra la API de S3 es indispensable crear un usuario que tenga los permisos suficientes. Esta tarea se realiza a través del &lt;a href=&#34;http://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html?icmpid=docs_iam_console&#34; target=&#34;_blank&#34;&gt;servicio de gestión de acceso e identidad (IAM)&lt;/a&gt; de AWS:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Crear un grupo y asociarle la política de permisos de sólo lectura (&lt;strong&gt;AmazonS3ReadOnlyAccess&lt;/strong&gt;).&lt;/li&gt;
&lt;li&gt;Crear un usuario con el tipo de acceso &lt;strong&gt;Programmatic access&lt;/strong&gt; y añadirlo al grupo anterior.&lt;/li&gt;
&lt;li&gt;Anotar el identificador de usuario (&lt;strong&gt;Access key ID&lt;/strong&gt;) y la contraseña (&lt;strong&gt;Secret access key&lt;/strong&gt;) del usuario generado ya que serán necesarios a continuación.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;3-2-descargar-los-logs-desde-amazon-s3&#34;&gt;3.2. Descargar los logs desde Amazon S3&lt;/h3&gt;

&lt;p&gt;Para poder descargar los logs en un directorio local (por ejemplo, &lt;em&gt;mylogs&lt;/em&gt;) usaremos la CLI de AWS que tiene &lt;a href=&#34;http://docs.aws.amazon.com/cli/latest/userguide/using-s3-commands.html&#34; target=&#34;_blank&#34;&gt;multitud de comandos&lt;/a&gt; que permiten automatizar muchas de las tareas. Para el caso de &lt;a href=&#34;https://es.wikipedia.org/wiki/MacOS&#34; target=&#34;_blank&#34;&gt;&lt;em&gt;macOS&lt;/em&gt;&lt;/a&gt;, nos bastará con seguir unos sencillos pasos:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Instalar la CLI de AWS siguiendo &lt;a href=&#34;http://docs.aws.amazon.com/cli/latest/userguide/installing.html&#34; target=&#34;_blank&#34;&gt;estas instrucciones&lt;/a&gt;.&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Configurarla con el comando &lt;em&gt;configure&lt;/em&gt;:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;aws configure&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Responder a las siguientes preguntas:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;AWS Access Key ID&lt;/strong&gt;. El identificador de usuario.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AWS Secret Access Key&lt;/strong&gt;. La contraseña del usuario.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Default region name&lt;/strong&gt;. En mi caso, &lt;em&gt;eu-west-1&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Default output format&lt;/strong&gt;. En mi caso, &lt;em&gt;None&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Crear un directorio donde descargar los logs (por ejemplo, &lt;em&gt;mylogs&lt;/em&gt;).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Ejecutar el comando &lt;em&gt;sync&lt;/em&gt; para descargar los logs, siendo &lt;em&gt;mybucket&lt;/em&gt; el nombre del bucket donde están los logs:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;aws s3 sync s3://mybucket/ mylogs/&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Por último, será necesario juntar todos los ficheros descargados en uno sólo para facilitar el análisis de los datos. En &lt;em&gt;macOS&lt;/em&gt; se puede usar un comando como el siguiente:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;cat mylogs/* &amp;gt; access.log&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&#34;conclusión&#34;&gt;Conclusión&lt;/h2&gt;

&lt;p&gt;La función &lt;em&gt;access logging&lt;/em&gt; de &lt;em&gt;Amazon S3&lt;/em&gt; nos permite registrar cada acceso que se produzca a nuestro website con datos valiosos sobre los mismos como son el solicitante, la respuesta del servidor y los tiempos.&lt;/p&gt;

&lt;p&gt;Gracias al análisis de este tipo de información podremos encontrar errores, usos inapropiados, problemas de seguridad e incluso estadísticas sobre nuestros visitantes. Estas cuestiones son las que se abordarán en el siguiente &lt;a href=&#34;http://www.alejandrolopezparra.es/post/awstats/&#34;&gt;post&lt;/a&gt; junto con el uso de la herramienta &lt;a href=&#34;http://www.awstats.org&#34; target=&#34;_blank&#34;&gt;AWStats&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Alojar websites estáticos en Amazon Simple Storage Service (S3)</title>
      <link>http://www.alejandrolopezparra.es/post/amazon_s3/</link>
      <pubDate>Sat, 11 Feb 2017 12:00:00 +0000</pubDate>
      
      <guid>http://www.alejandrolopezparra.es/post/amazon_s3/</guid>
      <description>

&lt;p&gt;Como continuación al &lt;a href=&#34;http://www.alejandrolopezparra.es/post/hugo/&#34;&gt;primer post&lt;/a&gt; en el que hablaba de &lt;a href=&#34;https://gohugo.io&#34; target=&#34;_blank&#34;&gt;Hugo&lt;/a&gt;, el framework usado para la creación de esta web, me gustaría seguir comentando otra de las tecnologías en las que se apoya. En esta ocasión es el turno del servicio &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html&#34; target=&#34;_blank&#34;&gt;Amazon Simple Storage Service (S3)&lt;/a&gt; que pertenece a la plataforma de servicios en la nube &lt;a href=&#34;https://aws.amazon.com/es/what-is-aws/&#34; target=&#34;_blank&#34;&gt;Amazon Web Services (AWS)&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Amazon S3&lt;/em&gt; es un servicio de pago para almacenamiento en la nube al estilo de &lt;a href=&#34;https://www.dropbox.com&#34; target=&#34;_blank&#34;&gt;Dropbox&lt;/a&gt;, &lt;a href=&#34;https://drive.google.com&#34; target=&#34;_blank&#34;&gt;Google Drive&lt;/a&gt; o &lt;a href=&#34;https://onedrive.live.com/about/es-es/&#34; target=&#34;_blank&#34;&gt;Microsoft OneDrive&lt;/a&gt;. Además de almacenar ficheros y directorios, &lt;strong&gt;permite alojar websites de contenido estático&lt;/strong&gt;, es decir, webs que se basan en HyperText Markup Language (HTML), JavaScript (JS) y Cascading Style Sheets (CSS). El contenido no es generado dinámicamente en cada solicitud que se realiza al servidor y, por tanto, no son necesarios ni servidores de aplicaciones ni de bases de datos. Sólo se requiere un servidor web que sirva el contenido según se le vaya solicitando. Afortunadamente, gracias a tecnologías que se ejecutan en el lado del cliente como JS y CSS, se puede conseguir cierto dinamismo en cómo se muestra el contenido aunque éste sea servido de forma estática.&lt;/p&gt;

&lt;p&gt;A continuación se describen los 2 pasos que hay que realizar para poder publicar una web estática: (1) alojar el website y (2) asociar un dominio.&lt;/p&gt;

&lt;h2 id=&#34;1-alojar-un-website-estático-en-amazon-s3&#34;&gt;1. Alojar un website estático en Amazon S3&lt;/h2&gt;

&lt;p&gt;La capacidad de alojamiento de webs estáticas de &lt;em&gt;Amazon S3&lt;/em&gt; está explicada en detalle &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html&#34; target=&#34;_blank&#34;&gt;aquí&lt;/a&gt; pero, en resumen, nos permite lo siguiente:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Crear un contenedor o depósito denominado &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html&#34; target=&#34;_blank&#34;&gt;Bucket&lt;/a&gt; que está físicamente en una &lt;a href=&#34;http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_website_region_endpoints&#34; target=&#34;_blank&#34;&gt;región&lt;/a&gt; o CPD de Amazon. &lt;em&gt;Los Buckets tienen que tener un nombre único en una región y ese nombre debe coincidir con el dominio DNS que pretandamos registrar posteriormente&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Almacenar los ficheros HTML y demás recursos webs asociados en dicho Bucket.&lt;/li&gt;
&lt;li&gt;Publicar el Bucket a través de un &lt;a href=&#34;http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteEndpoints.html&#34; target=&#34;_blank&#34;&gt;Endpoint&lt;/a&gt;. Un Endpoint apunta a un Bucket concreto que se encuentra en una región en particular. En mi caso es &lt;a href=&#34;http://www.alejandrolopezparra.es.s3-website-eu-west-1.amazonaws.com&#34; target=&#34;_blank&#34;&gt;www.alejandrolopezparra.es.s3-website-eu-west-1.amazonaws.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Configurar cuál es la página &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/IndexDocumentSupport.html&#34; target=&#34;_blank&#34;&gt;index&lt;/a&gt; (página que se cargará por defecto) y la que se muestra en caso de &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/CustomErrorDocSupport.html&#34; target=&#34;_blank&#34;&gt;error&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Activar los &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html&#34; target=&#34;_blank&#34;&gt;ficheros de logs&lt;/a&gt; para registrar los accesos que se produzcan al servidor. Más información sobre esto en el post dedicado a los &lt;a href=&#34;http://www.alejandrolopezparra.es/post/amazon_s3_logs/&#34;&gt;logs de Amazon S3&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;También contamos con un &lt;a href=&#34;https://console.aws.amazon.com/quickstart-website/new&#34; target=&#34;_blank&#34;&gt;asistente o guía rápida&lt;/a&gt; que nos facilita el proceso de alojamiento de un nuevo website.&lt;/p&gt;

&lt;h2 id=&#34;2-asociar-un-dominio-propio&#34;&gt;2. Asociar un dominio propio&lt;/h2&gt;

&lt;p&gt;Una vez tenemos nuestro website alojado en un Bucket y lo hemos publicado en un Endpoint, es el momento de asociarle un nombre de un dominio propio, por ejemplo &lt;a href=&#34;http://www.alejandrolopezparra.es&#34; target=&#34;_blank&#34;&gt;www.alejandrolopezparra.es&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Para lograrlo es necesario &lt;strong&gt;registrar el dominio&lt;/strong&gt; en un registrador de dominios y &lt;strong&gt;crear un nombre en ese dominio&lt;/strong&gt; a través de un servicio DNS que apunte al Endpoint definido anteriormente mediante lo que se conoce como alias. De esta forma, cuando un navegador web intente resolver dicho nombre, recibirá como respuesta el endpoint donde tenemos alojado nuestro website. Lo habitual es crear un alias para el subdominio &lt;em&gt;www&lt;/em&gt; aunque en algunos proveedores DNS también es posible crear un alias para el dominio raíz. Es muy importante tener en cuenta que &lt;em&gt;cada alias tiene que apuntar a un Endpoint concreto y el nombre del alias debe coincidir con el nombre del Endpoint&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Existen multitud de registradores de dominios y muchos de ellos también proporcionan servicios DNS. Amazon ofrece estos servicios a través de &lt;a href=&#34;https://aws.amazon.com/es/route53/&#34; target=&#34;_blank&#34;&gt;Amazon Route 53&lt;/a&gt; y dispone de una &lt;a href=&#34;https://docs.aws.amazon.com/AmazonS3/latest/dev/website-hosting-custom-domain-walkthrough.html#root-domain-walkthrough-switch-to-route53-as-dnsprovider&#34; target=&#34;_blank&#34;&gt;guía&lt;/a&gt; en la que explican cómo llevarlo a cabo. Otro prestador muy conocido de este tipo de servicios es &lt;a href=&#34;http://dyn.com&#34; target=&#34;_blank&#34;&gt;Dyn&lt;/a&gt;. En mi caso, uso &lt;a href=&#34;https://es.godaddy.com&#34; target=&#34;_blank&#34;&gt;GoDaddy&lt;/a&gt; para ambas cosas aunque tiene la pega de no permitir alias del dominio raíz por lo que sólo se pueden usar en los subdominios.&lt;/p&gt;

&lt;h2 id=&#34;conclusión&#34;&gt;Conclusión&lt;/h2&gt;

&lt;p&gt;&lt;em&gt;Amazon S3&lt;/em&gt; permite el alojamiento de websites estáticos de forma fácil y con precios económicos, especialmente el primer año que es &lt;a href=&#34;https://aws.amazon.com/es/free/&#34; target=&#34;_blank&#34;&gt;gratuito&lt;/a&gt;. A partir de ahí, el modelo de negocio se basa en pago por uso de almacenamiento y trasferencia de datos (tanto de subida como de descarga). Para webs personales o con poco tráfico es idóneo porque la factura es muy baja si no hay muchas visitas. Incluso te permite definir alertas cuando el sistema prevee que se pueden superar ciertos umbrales.&lt;/p&gt;

&lt;p&gt;Existen otras alternativas que merecerían la pena explorar para valorar la que mejor se adapta a las necesidades de cada uno:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://cloud.google.com/storage/&#34; target=&#34;_blank&#34;&gt;Google Cloud Storage&lt;/a&gt; con su &lt;a href=&#34;https://cloud.google.com/storage/docs/hosting-static-website&#34; target=&#34;_blank&#34;&gt;guía&lt;/a&gt;. De pago.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://pages.github.com&#34; target=&#34;_blank&#34;&gt;Github Pages&lt;/a&gt; que dispone de un &lt;a href=&#34;https://gohugo.io/tutorials/github-pages-blog/&#34; target=&#34;_blank&#34;&gt;tutorial&lt;/a&gt; para &lt;a href=&#34;https://gohugo.io&#34; target=&#34;_blank&#34;&gt;Hugo&lt;/a&gt;. Gratuito.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://bitbucket.org/&#34; target=&#34;_blank&#34;&gt;BitBucket&lt;/a&gt; que también tiene un &lt;a href=&#34;https://gohugo.io/tutorials/hosting-on-bitbucket/&#34; target=&#34;_blank&#34;&gt;tutorial&lt;/a&gt; para &lt;a href=&#34;https://gohugo.io&#34; target=&#34;_blank&#34;&gt;Hugo&lt;/a&gt;. Gratuito.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://about.gitlab.com/&#34; target=&#34;_blank&#34;&gt;GitLab&lt;/a&gt; que también ofrece un &lt;a href=&#34;https://gohugo.io/tutorials/hosting-on-gitlab/&#34; target=&#34;_blank&#34;&gt;tutorial&lt;/a&gt; para &lt;a href=&#34;https://gohugo.io&#34; target=&#34;_blank&#34;&gt;Hugo&lt;/a&gt;. Gratuito.&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>
