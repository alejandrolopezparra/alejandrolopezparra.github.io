<!DOCTYPE html>
<html lang="es-es">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.40.3" />
  

  
  
  
  
    
      
    
  
  <meta name="description" content="El viernes 12 de mayo de 2017, a media mañana, los medios generalistas se hicieron eco de un ciberataque de tipo ransomware que estaba afectando a grandes compañias en España y otros países. Esta noticia fue cabecera de la mayoría de los informativos, telediarios y programas de variadades, durante todo el fin de semana y algunos días después, a nivel mundial. Me atrevería a decir que ha sido el ciberataque con más repercusión en los medios de toda la historia.">

  
  <link rel="alternate" hreflang="es-es" href="https://www.alejandrolopezparra.es/post/wannacry_analisis/">

  


  

  
  
  <meta name="theme-color" content="#3f51b5">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  
  <link rel="stylesheet" href="/css/custom.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-103012229-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="https://www.alejandrolopezparra.es/index.xml" type="application/rss+xml" title="Alejandro López Parra">
  <link rel="feed" href="https://www.alejandrolopezparra.es/index.xml" type="application/rss+xml" title="Alejandro López Parra">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://www.alejandrolopezparra.es/post/wannacry_analisis/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@ALopezParra">
  <meta property="twitter:creator" content="@ALopezParra">
  
  <meta property="og:site_name" content="Alejandro López Parra">
  <meta property="og:url" content="https://www.alejandrolopezparra.es/post/wannacry_analisis/">
  <meta property="og:title" content="WannaCry, el ransomworm más mediático | Alejandro López Parra">
  <meta property="og:description" content="El viernes 12 de mayo de 2017, a media mañana, los medios generalistas se hicieron eco de un ciberataque de tipo ransomware que estaba afectando a grandes compañias en España y otros países. Esta noticia fue cabecera de la mayoría de los informativos, telediarios y programas de variadades, durante todo el fin de semana y algunos días después, a nivel mundial. Me atrevería a decir que ha sido el ciberataque con más repercusión en los medios de toda la historia."><meta property="og:image" content="https://www.alejandrolopezparra.es/img/posts/WannaCry-Decrypt0r.png">
  <meta property="og:locale" content="es-es">
  
  <meta property="article:published_time" content="2017-07-08T12:00:00&#43;02:00">
  
  <meta property="article:modified_time" content="2017-07-08T12:00:00&#43;02:00">
  

  
  

  <title>WannaCry, el ransomworm más mediático | Alejandro López Parra</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Barra de navegación</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Alejandro López Parra</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Charlas</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Bio</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  
  
    <img src="/img/posts/WannaCry-Decrypt0r.png" class="article-banner" itemprop="image">
  

  
</div>



  <div class="article-container">
    <h1 itemprop="name">WannaCry, el ransomworm más mediático</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-07-08 12:00:00 &#43;0200 CEST" itemprop="datePublished dateModified">
      2017-07-08, Saturday
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    8 min de lectura
  </span>
  

  
  

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=WannaCry%2c%20el%20ransomworm%20m%c3%a1s%20medi%c3%a1tico&amp;url=https%3a%2f%2fwww.alejandrolopezparra.es%2fpost%2fwannacry_analisis%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.alejandrolopezparra.es%2fpost%2fwannacry_analisis%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.alejandrolopezparra.es%2fpost%2fwannacry_analisis%2f&amp;title=WannaCry%2c%20el%20ransomworm%20m%c3%a1s%20medi%c3%a1tico"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fwww.alejandrolopezparra.es%2fpost%2fwannacry_analisis%2f&amp;title=WannaCry%2c%20el%20ransomworm%20m%c3%a1s%20medi%c3%a1tico"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=WannaCry%2c%20el%20ransomworm%20m%c3%a1s%20medi%c3%a1tico&amp;body=https%3a%2f%2fwww.alejandrolopezparra.es%2fpost%2fwannacry_analisis%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      

<p>El <strong>viernes 12 de mayo de 2017</strong>, a media mañana, los medios generalistas se hicieron eco de un ciberataque de tipo <a href="https://es.wikipedia.org/wiki/Ransomware" target="_blank"><em>ransomware</em></a> que estaba afectando a grandes compañias en España y otros países. Esta noticia fue cabecera de la mayoría de los informativos, telediarios y programas de variadades, durante todo el fin de semana y algunos días después, a nivel mundial. Me atrevería a decir que ha sido <strong>el ciberataque con más repercusión en los medios</strong> de toda la historia.</p>

<p>Aunque ha recibido distintos nombres desde que salió a la luz (<em>WCry</em>, <em>WanaCry</em>, <em>Wana Decrypt0r</em>, <em>WannaCrypt0r</em>, <em>WannaCrypt</em>) parece que el que finalmente ha conseguido mayor aceptación es el de <strong><em>WannaCry</em></strong>, que hace alusión a que los afectados <strong>quieren llorar</strong> por haber perdido todos sus datos.</p>

<p>A continuación se tratarán el análisis de las características técnicas del <em>malware</em>, las medidas de prevención y la recuperación.</p>

<h2 id="análisis-de-wannacry">Análisis de <em>WannaCry</em></h2>

<p><em>WannaCry</em> es un malware para diferentes versiones del sistema operativo <em>Microsoft Windows</em> que combina varios comportamientos maliciosos:</p>

<ul>
<li><a href="https://es.wikipedia.org/wiki/Ransomware" target="_blank"><strong><em>Ransomware</em></strong></a>: secuestra los documentos digitales de los equipos y pide un rescate económico para recuperarlos.</li>
<li><a href="https://es.wikipedia.org/wiki/Worm" target="_blank"><strong><em>Worm</em></strong></a>: se propaga automáticamente para infectar a la mayor cantidad de equipos posibles.</li>
</ul>

<p>Éstas son algunas de las fuentes en las que se basa este post para el análisis del <em>malware</em>:</p>

<ul>
<li><a href="https://www.certsi.es/blog/ransomware-wannacry-responsable-ciberataque-mundial" target="_blank">CERT de Seguridad e Industria</a>.</li>
<li><a href="https://blog.malwarebytes.com/threat-analysis/2017/05/the-worm-that-spreads-wanacrypt0r/" target="_blank">MalwareBytes</a>.</li>
<li><a href="https://gist.github.com/rain-1/989428fa5504f378b993ee6efbc0b168" target="_blank">Wannacrypt0r-FACTSHEET</a>.</li>
<li><a href="http://blog.talosintelligence.com/2017/05/wannacry.html" target="_blank">Cisco Talos</a>.</li>
<li><a href="https://blog.kryptoslogic.com/malware/2017/05/29/two-weeks-later.html" target="_blank">Kryptos Logic</a>.</li>
<li><a href="https://www.endgame.com/blog/technical-blog/wcrywanacry-ransomware-technical-analysis" target="_blank">EndGame</a>.</li>
<li><a href="https://blogs.forcepoint.com/security-labs/wannacry-post-outbreak-analysis" target="_blank">Forcepoint</a>.</li>
<li><a href="https://baesystemsai.blogspot.com.es/2017/05/wanacrypt0r-ransomworm.html" target="_blank">BAE Systems</a>.</li>
<li><a href="https://blogs.technet.microsoft.com/mmpc/2017/05/12/wannacrypt-ransomware-worm-targets-out-of-date-systems/" target="_blank">Microsoft</a>.</li>
<li><a href="https://www.gdatasoftware.com/blog/2017/05/29751-wannacry-ransomware-campaign" target="_blank">G Data</a>.</li>
<li><a href="http://thehackernews.com/2017/05/how-to-wannacry-ransomware.html" target="_blank">The Hacker News</a>.</li>
<li><a href="https://blog.sonicwall.com/2017/06/did-wannacry-perpetrators-ever-get-their-ransom/" target="_blank">SonicWall</a>.</li>
</ul>

<h3 id="worm"><em>Worm</em></h3>

<p>Posee un módulo que se encarga de <strong>propagarse por la red sin intervención del usuario</strong> para infectar otros equipos e inyectarse en ellos.</p>

<p>Para conseguirlo, usa un <a href="https://es.wikipedia.org/wiki/Exploit" target="_blank"><em>exploit</em></a> conocido como <a href="https://es.wikipedia.org/wiki/EternalBlue" target="_blank"><em>EternalBlue</em></a> que instala un <a href="https://es.wikipedia.org/wiki/Puerta_trasera" target="_blank"><em>backdoor</em></a> denominado <a href="https://en.wikipedia.org/wiki/DoublePulsar" target="_blank">DoublePulsar</a> a través del cuál se instala el <em>malware</em>. Tanto <em>EternalBlue</em> como <em>DoublePulsar</em> son herramientas desarrolladas, suspuestamente para la <a href="https://es.wikipedia.org/wiki/Agencia_de_Seguridad_Nacional" target="_blank">Agencia de Seguridad de los Estados Unidos (NSA)</a>, por el grupo de hackers <a href="https://en.wikipedia.org/wiki/Equation_Group" target="_blank">Equation Group</a>.</p>

<p><em>EternalBlue</em> es una herramienta que aprovecha la vulnerabilidad <a href="https://www.certsi.es/alerta-temprana/vulnerabilidades/cve-2017-0144" target="_blank">cve-2017-0144</a> del protocolo <a href="https://es.wikipedia.org/wiki/Server_Message_Block" target="_blank"><em>Server Message Block 1.0</em> (<em>SMBv1</em>)</a> de los sistemas operativos <em>Windows</em>. Aunque esta vulnerabilidad afecta a todos los equipos con <em>Windows XP/Vista/7/8/10</em> y <em>Windows Server 2003/2008/2012/2016</em> que no estén convenientemente actualizados, los análisis realizados demuestran que <strong><em>Windows XP</em>, <em>Windows 10</em> y <em>Windows Server 2016</em> no se infectan</strong>. Esto se debe a que el <em>exploit</em> no está diseñado para estos sistemas operativos y falla al intentar aprovechar la vulnerabilidad.</p>

<p>Una vez infectado un equipo, el <em>malware</em> comprueba si puede conectarse a esta página web</p>

<p><code>www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com</code></p>

<ul>
<li>En caso de que pueda acceder, se desactiva y no realiza ninguna acción en el equipo.</li>
<li>En caso de que no pueda conectarse, intenta propagarse a otros equipos y ejecuta el componente <em>ransomware</em>.</li>
</ul>

<p>Debido a este comportamiento, se conoce a esa página como <strong><em>kill switch</em></strong> o interruptor de apagado de emergencia ya que permite detener la propagación de este <em>malware</em>.</p>

<h3 id="ransomware"><em>Ransomware</em></h3>

<p>El proceso realizado por el componente <em>ransomware</em>, una vez un equipo ha sido infectado, es (1) preparar el sistema, (2) cifrar los ficheros y (3) solicitar un rescate.</p>

<h4 id="preparación">Preparación</h4>

<p>Posee un módulo que <strong>busca</strong> documentos ofimáticos, imágenes, archivos multimedia, bases de datos y otros tipos de ficheros comunes, tanto en el propio equipo como en todas las unidades que tenga conectadas por red. El listado de extensiones de ficheros que intenta localizar es grande, más de 150 (.doc, .pdf, .jpg, .png, .avi, &hellip;), pero ignora deliberadamente los ficheros necesarios para el correcto funcionamiento del Sistema Operativo.</p>

<h4 id="cifrado">Cifrado</h4>

<p>Para secuestrar los ficheros, utiliza algoritmos de <a href="https://es.wikipedia.org/wiki/Criptograf%C3%ADa_asim%C3%A9trica" target="_blank">criptografía asimétrica o de dos claves</a> (privada y pública), que son más seguros, combinados con <a href="https://es.wikipedia.org/wiki/Criptograf%C3%ADa_sim%C3%A9trica" target="_blank">criptografía simétrica o de clave secreta</a>, que son más rápidos.</p>

<p>De forma resumida, podríamos decir que <strong>cada fichero es cifrado con una clave aleatoria distinta que solamente pueden averiguar los atacantes</strong>. A continuación se dan detalles técnicos del proceso de cifrado que ayudan a entenderlo.</p>

<h5 id="descripción-técnica-del-cifrado">Descripción técnica del cifrado</h5>

<p>Lo primero que realiza es la <strong>generación de claves asimétricas</strong> robustas <code>RSA-2048</code> que usará posteriormente:</p>

<ol>
<li>Extrae una clave pública (<em>PuK</em>) que lleva en su código y que tiene asociada una clave privada (<em>PrK</em>) que no se incluye.</li>
<li>Genera aleatoriamente un nuevo par de claves pública (<em>PuKN</em>) y privada (<em>PrKN</em>).</li>
<li>Guarda <em>PuKN</em> en el fichero <code>00000000.pky</code>.</li>
<li>Guarda <em>PrKN</em> en el fichero <code>00000000.eky</code>, cifrado con la clave pública <em>PuK</em>, de manera que sólo es descifrable con <em>PrK</em>.</li>
<li>Destruye las claves de la memoria para que no sean recuperables.</li>
</ol>

<p>Después, para cada fichero localizado, lo <strong>cifra con una clave simétrica</strong> <code>AES-128-CBC</code> distinta en cada caso:</p>

<ol>
<li>Genera aleatoriamente una clave secreta (<em>Sec</em>).</li>
<li>Realiza una copia cifrada del fichero original con <em>Sec</em> y le añade la extensión <code>.WNCRY</code>.</li>
<li>Adjunta <em>Sec</em>, cifrada con <em>PuKN</em>, a la cabecera del fichero. De esta forma, sólo es descifrable si se conoce <em>PrKN</em> que a su vez ha sido cifrada con <em>PuK</em>.</li>
<li>Borra de forma segura el fichero original para que no se pueda restaurar.</li>
<li>Destruye la clave secreta de memoria para que no sea recuperable.</li>
</ol>

<p>De esta forma, cada fichero es cifrado con una clave simétrica distinta <em>Sec</em> que está protegida por una clave asimétrica <em>PrKN</em> que sólo se puede recuperar con la clave asimétrica <em>PrK</em> que tienen los creadores de <em>WannaCry</em>.</p>

<h4 id="rescate">Rescate</h4>

<p>Una vez cifrados todos los ficheros, el <em>malware</em> cambia el fondo de escritorio por un mensaje que avisa de que todos los ficheros han sido cifrados. De la misma forma, muestra una ventana con las intrucciones para pagar <strong>300 $</strong> en <a href="https://es.wikipedia.org/wiki/Bitcoin" target="_blank"><em>Bitcoins</em> (<em>BTC</em>)</a> mediante una trasferencia a una de las siguientes carteras de <em>Bitcoins</em>:</p>

<ul>
<li><a href="https://blockchain.info/address/12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw" target="_blank">12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw</a>.</li>
<li><a href="https://blockchain.info/address/115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn" target="_blank">115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn</a>.</li>
<li><a href="https://blockchain.info/address/13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94" target="_blank">13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94</a>.</li>
</ul>

<p>También se muestra un contador de tiempo que indica que esta cantidad se verá incrementada a <strong>600 $</strong> si no se realiza el pago antes de <strong>3 días</strong>. Por si fuera poco, amenaza con que <strong>los datos no serán recuperables</strong> en caso de no realizar el pago antes de <strong>7 días</strong>.</p>

<p>En paralelo, el <em>malware</em> envía, a través de la red de anonimato <a href="https://es.wikipedia.org/wiki/Tor_(red_de_anonimato)" target="_blank"><em>Tor</em></a>, el archivo <code>00000000.eky</code>, que contiene la clave privada cifrada necesaria para recuperar los ficheros, a unos de los seguientes <a href="https://es.wikipedia.org/wiki/Tor_(red_de_anonimato)#Servicios_ocultos" target="_blank">servicios ocultos de <em>Tor</em></a> que actuán de panel de control:</p>

<ul>
<li><code>gx7ekbenv2riucmf[.]onion</code></li>
<li><code>57g7spgrzlojinas[.]onion</code></li>
<li><code>xxlvbrloxvriy2c5[.]onion</code></li>
<li><code>76jdd2ir2embyv47[.]onion</code></li>
<li><code>cwwnhwhlz52maqm7[.]onion</code></li>
</ul>

<p>Una vez pagado el rescate, supuestamente, los atacantes entregarían el archivo <code>00000000.dky</code>, que contiene la clave privada en claro necesaria para descifrar los ficheros secuestrados. El problema aquí radica en que <strong>los pagos en <em>Bitcoins</em> son anónimos</strong> por lo que no es directo saber quién ha realizado el pago y quién no.</p>

<p>Ya que no hay garantía de que esto ocurra y para no fomentar este tipo de actos delictivos, <strong>la recomendación es nunca pagar un rescate</strong>.</p>

<h3 id="versiones-de-wannacry">Versiones de <em>WannaCry</em></h3>

<p>Hasta la fecha, se han identificado unas cuantas variantes del <em>malware</em> que se diferencian en su comportamiento como <em>worm</em> o como <em>ransomware</em>.</p>

<p>Podemos clasificar las versiones en alguna de estos tipos:</p>

<ul>
<li>En base al <strong><em>kill switch</em></strong> o dominio que use como interruptor de emergencia. En algunas versiones incluso ha sido eliminado.</li>
<li>En base a la <strong>cartera de <em>Bitcoins</em></strong> donde se reclame el pago.</li>
</ul>

<p>Se cree que las versiones no han sido creadas por los autores originales sino que, más bien, se tratan de modificaciones realizadas por terceros.</p>

<h2 id="prevención-y-mitigación">Prevención y mitigación</h2>

<p>La vulnerabilidad utilizada por <em>WannaCry</em> está presente en todos los equipos con <em>Windows XP</em> a <em>Windows 10</em> que no hayan aplicado el parche de seguridad:</p>

<ul>
<li><a href="https://technet.microsoft.com/es-es/library/security/ms17-010.aspx" target="_blank"><em>MS17-10</em></a> que se publicó el <strong>14 de marzo de 2017</strong> para los sistemas soportados oficialmente (<em>Windows Vista/2008/7/2012/8.1/10/2016</em>).</li>
<li><a href="http://www.catalog.update.microsoft.com/search.aspx?q=kb4012598" target="_blank"><em>KB4012598</em></a> que se publicó, de forma excepcional, el <strong>13 de mayo de 2017</strong> para los que ya no tienen soporte (<em>Windows XP/2003/8</em>).</li>
</ul>

<p>En caso de no ser posible aplicar el parche de seguridad, se pueden adoptar medidas de mitigación como las que indica el <a href="https://www.certsi.es/alerta-temprana/avisos-seguridad/oleada-ransomware-afecta-multitud-equipos" target="_blank">aviso de seguridad</a> que realizó el <a href="https://www.certsi.es" target="_blank">CERT de Seguridad e Industria</a> de <a href="https://www.incibe.es" target="_blank">INCIBE</a>.</p>

<h2 id="desinfección-y-recuperación">Desinfección y recuperación</h2>

<p>La <strong>desinfección</strong> se puede realizar con un antivirus actualizado ya que la mayoría de ellos detectan y desinfectan este <em>malware</em> desde poco después de su aparición. De todas formas, lo más recomendable es recuperar la última copia de seguridad que tengamos del equipo o realizar una instalación nueva en caso contrario.</p>

<p>La <strong>recuperación</strong>, sin embargo, no es tan sencilla ya que la clave privada que se usa en el proceso de cifrado de los ficheros es eliminada de la memoria y guardada cifrada en el archivo <code>00000000.eky</code>. La única posibilidad de obtenerla sería con la clave privada maestra que está en posesión de los creadores de <em>WannaCry</em>.</p>

<p>No obstante, existe una remota posibilidad de recuperar la clave privada de la memoria del sistema que es usar la herramienta <a href="https://github.com/gentilkiwi/wanakiwi" target="_blank"><strong><em>Wanakiwi</em></strong></a> pero sólo cuando se dan las siguientes circunstancias:</p>

<ul>
<li>El sistema operativo es <em>Windows XP</em> o <em>Windows 7</em>.</li>
<li>No se ha reiniciado el equipo desde que se infectó.</li>
<li>No ha pasado mucho tiempo desde el equipo se infectó o ha sido puesto en <a href="https://en.wikipedia.org/wiki/Sleep_mode" target="_blank"><em>suspensión</em></a> o <a href="https://en.wikipedia.org/wiki/Hibernation_(computing)" target="_blank"><em>hibernación</em></a> al poco de ser infectado.</li>
</ul>

<h2 id="conclusiones">Conclusiones</h2>

<p>El análisis del malware pone de manifiesto que nos encontramos ante una <strong>amenaza no especialmente sofisticada</strong> ya que explota una vulnerabilidad conocida, para la que existían parches de seguridad desde meses antes.</p>

<p>Lo que sí ha quedado claro es la <strong>falta de política de actualización</strong> en muchas entidades o, como mínimo, que no se siguen. De la misma forma, también ha quedado evidenciado que tampoco se siguen las <strong>políticas y procedimientos de bastionado</strong>, ya que ni lo más básico se ha seguido, como es evitar la exposición en Internet de servicios innesarios o el filtrado para el acceso a los mismos.</p>

<p>Esperemos que la trascendencia medíatica que ha tenido este suceso sirva para que <strong>las entidades empiecen a tomarse más en serio esto de la seguridad</strong> y se pongan las pilas en procedimientos tan básicos como las actualizaciones periódicas y el bastionado de los sistemas.</p>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="https://www.alejandrolopezparra.es/tags/malware/">malware</a>
  
  <a class="btn btn-primary btn-outline" href="https://www.alejandrolopezparra.es/tags/ciberataque/">ciberataque</a>
  
  <a class="btn btn-primary btn-outline" href="https://www.alejandrolopezparra.es/tags/seguridad/">seguridad</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Relacionado</h3>
      <ul>
        
        <li><a href="/talk/rtvcyl_vamos_a_ver/">El ciberataque WannaCry</a></li>
        
        <li><a href="/talk/iv_jornada_ciberseguridad_andalucia/">Seguridad en industria, infraestucturas y smart cities</a></li>
        
        <li><a href="/post/fnmt/">Certificados digitales de la FNMT-RCM</a></li>
        
        <li><a href="/post/dnie/">DNI electrónico y certificados digitales</a></li>
        
        <li><a href="/talk/vi_reunion_foro_interoperabilidad_salud/">Interoperabilidad, Big Data y Seguridad</a></li>
        
      </ul>
    </div>
    

    

    


  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 Alejandro López Parra &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Citar</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copiar
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

